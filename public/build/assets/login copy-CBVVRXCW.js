import{r as c,j as e,m as A,L as K}from"./app-D1PyiKA2.js";import{I as S}from"./input-error-2NuU8knq.js";import{T as D}from"./text-link-C50Q0KhZ.js";import{u as z,B as E}from"./button-BZb6eFa3.js";import{u as $,c as H,a as _,P as X,b as V}from"./index-fnwY9HLb.js";import{P as F}from"./index-DwIuxz98.js";import{c as G}from"./utils-jAU0Cazi.js";import{c as J}from"./createLucideIcon-_Gm4vGiG.js";import{L as k,I}from"./label-Ct3-ps5F.js";import{A as Q}from"./auth-layout-hBfiNmmS.js";import{L as R}from"./loader-circle-CIrtikCW.js";import"./index-Cht7Sf4o.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],W=J("Check",U);function Y(s){const i=c.useRef({value:s,previous:s});return c.useMemo(()=>(i.current.value!==s&&(i.current.previous=i.current.value,i.current.value=s),i.current.previous),[s])}var O="Checkbox",[Z,ge]=H(O),[ee,te]=Z(O),q=c.forwardRef((s,i)=>{const{__scopeCheckbox:n,name:x,checked:v,defaultChecked:m,required:u,disabled:o,value:l="on",onCheckedChange:f,form:d,...h}=s,[p,j]=c.useState(null),C=z(i,t=>j(t)),w=c.useRef(!1),P=p?d||!!p.closest("form"):!0,[b=!1,y]=$({prop:v,defaultProp:m,onChange:f}),r=c.useRef(b);return c.useEffect(()=>{const t=p==null?void 0:p.form;if(t){const a=()=>y(r.current);return t.addEventListener("reset",a),()=>t.removeEventListener("reset",a)}},[p,y]),e.jsxs(ee,{scope:n,state:b,disabled:o,children:[e.jsx(F.button,{type:"button",role:"checkbox","aria-checked":g(b)?"mixed":b,"aria-required":u,"data-state":M(b),"data-disabled":o?"":void 0,disabled:o,value:l,...h,ref:C,onKeyDown:_(s.onKeyDown,t=>{t.key==="Enter"&&t.preventDefault()}),onClick:_(s.onClick,t=>{y(a=>g(a)?!0:!a),P&&(w.current=t.isPropagationStopped(),w.current||t.stopPropagation())})}),P&&e.jsx(se,{control:p,bubbles:!w.current,name:x,value:l,checked:b,required:u,disabled:o,form:d,style:{transform:"translateX(-100%)"},defaultChecked:g(m)?!1:m})]})});q.displayName=O;var T="CheckboxIndicator",B=c.forwardRef((s,i)=>{const{__scopeCheckbox:n,forceMount:x,...v}=s,m=te(T,n);return e.jsx(X,{present:x||g(m.state)||m.state===!0,children:e.jsx(F.span,{"data-state":M(m.state),"data-disabled":m.disabled?"":void 0,...v,ref:i,style:{pointerEvents:"none",...s.style}})})});B.displayName=T;var se=s=>{const{control:i,checked:n,bubbles:x=!0,defaultChecked:v,...m}=s,u=c.useRef(null),o=Y(n),l=V(i);c.useEffect(()=>{const d=u.current,h=window.HTMLInputElement.prototype,j=Object.getOwnPropertyDescriptor(h,"checked").set;if(o!==n&&j){const C=new Event("click",{bubbles:x});d.indeterminate=g(n),j.call(d,g(n)?!1:n),d.dispatchEvent(C)}},[o,n,x]);const f=c.useRef(g(n)?!1:n);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:v??f.current,...m,tabIndex:-1,ref:u,style:{...s.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function g(s){return s==="indeterminate"}function M(s){return g(s)?"indeterminate":s?"checked":"unchecked"}var re=q,ae=B;function oe({className:s,...i}){return e.jsx(re,{"data-slot":"checkbox",className:G("peer border-input data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...i,children:e.jsx(ae,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(W,{className:"size-3.5"})})})}function ve({status:s,canResetPassword:i}){const[n,x]=c.useState(!1),[v,m]=c.useState(!1),u=c.useRef([]),{data:o,setData:l,post:f,processing:d,errors:h,reset:p}=A({email:"",password:"",remember:!1,otp_arr:["","","","","",""],otp:""}),j=r=>{r.preventDefault(),f(route("login"),{onFinish:()=>p("password")})},C=r=>{r.preventDefault(),f(route("login.otp.store"),{onSuccess:()=>m(!0)})},w=r=>{r.preventDefault(),f(route("login.otp.verify"))},P=(r,t)=>{var N;const{value:a}=r.target;if(/^\d*$/.test(a)&&a.length<=1){const L=[...o.otp_arr];L[t]=a,l("otp_arr",L),l("otp",L.join("")),a&&t<5&&((N=u.current[t+1])==null||N.focus())}},b=(r,t)=>{var a;r.key==="Backspace"&&!o.otp_arr[t]&&t>0&&((a=u.current[t-1])==null||a.focus())},y=r=>{var a;r.preventDefault();const t=r.clipboardData.getData("text/plain").trim();if(/^\d{6}$/.test(t)){const N=t.split("");l("otp_arr",N),l("otp",N.join("")),(a=u.current[5])==null||a.focus(),f(route("login.otp.verify"))}};return e.jsxs(Q,{title:"Log in to your account",description:"Enter your email and password below to log in",children:[e.jsx(K,{title:"Log in"}),n?v?e.jsx("form",{className:"flex flex-col gap-6",onSubmit:w,children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(k,{htmlFor:"email",children:"Email address"}),e.jsx(I,{id:"email",type:"email",readOnly:!0,value:o.email,className:"bg-gray-100 cursor-not-allowed"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(k,{htmlFor:"otp",children:"OTP"}),e.jsx("div",{className:"flex space-x-2",children:o.otp_arr.map((r,t)=>e.jsx(I,{id:`otp-${t}`,type:"text",maxLength:1,value:r,onChange:a=>P(a,t),onKeyDown:a=>b(a,t),onPaste:t===0?y:void 0,ref:a=>u.current[t]=a,className:"w-12 text-center",tabIndex:t+1},t))}),e.jsx(S,{message:h.otp})]}),e.jsxs(E,{type:"submit",className:"mt-4 w-full",tabIndex:7,disabled:d,children:[d&&e.jsx(R,{className:"h-4 w-4 animate-spin"}),"Log in"]})]})}):e.jsx("form",{className:"flex flex-col gap-6",onSubmit:C,children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(k,{htmlFor:"email",children:"Email address"}),e.jsx(I,{id:"email",type:"email",required:!0,autoFocus:!0,tabIndex:1,autoComplete:"email",value:o.email,onChange:r=>l("email",r.target.value),placeholder:"email@example.com"}),e.jsx(S,{message:h.email})]}),e.jsxs(E,{type:"submit",className:"mt-4 w-full",tabIndex:2,disabled:d,children:[d&&e.jsx(R,{className:"h-4 w-4 animate-spin"}),"Send OTP to mail"]})]})}):e.jsx("form",{className:"flex flex-col gap-6",onSubmit:j,children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(k,{htmlFor:"email",children:"Email address"}),e.jsx(I,{id:"email",type:"email",required:!0,autoFocus:!0,tabIndex:1,autoComplete:"email",value:o.email,onChange:r=>l("email",r.target.value),placeholder:"email@example.com"}),e.jsx(S,{message:h.email})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{htmlFor:"password",children:"Password"}),i&&e.jsx(D,{href:route("password.request"),className:"ml-auto text-sm",tabIndex:5,children:"Forgot password?"})]}),e.jsx(I,{id:"password",type:"password",required:!0,tabIndex:2,autoComplete:"current-password",value:o.password,onChange:r=>l("password",r.target.value),placeholder:"Password"}),e.jsx(S,{message:h.password})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(oe,{id:"remember",name:"remember",checked:o.remember,onClick:()=>l("remember",!o.remember),tabIndex:3}),e.jsx(k,{htmlFor:"remember",children:"Remember me"})]}),e.jsxs(E,{type:"submit",className:"mt-4 w-full",tabIndex:4,disabled:d,children:[d&&e.jsx(R,{className:"h-4 w-4 animate-spin"}),"Log in"]})]})}),e.jsx("div",{className:"mt-4 text-center text-sm",children:e.jsx(E,{variant:"link",onClick:()=>x(!n),children:n?"Sign in with password":"Sign in with OTP"})}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:["Don't have an account?"," ",e.jsx(D,{href:route("register"),tabIndex:5,children:"Sign up"})]}),s&&e.jsx("div",{className:"mb-4 text-center text-sm font-medium text-green-600",children:s})]})}export{ve as default};
