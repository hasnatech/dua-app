import{r as f,m as S,j as e,L as D}from"./app-BpBjhaRR.js";import{I as h}from"./input-error-DQw595xv.js";import{T as I}from"./text-link-D7P3JGel.js";import{B as g}from"./button-C6KFz86U.js";import{L as c,I as d}from"./label-DW9B3cWk.js";import{A as E}from"./auth-layout-CTcyc1u1.js";import{L as j}from"./loader-circle-CXedByCL.js";import"./utils-jAU0Cazi.js";import"./index-2rlIc4Ch.js";import"./index-D7DgJIiL.js";import"./createLucideIcon-Brk--FRU.js";function K({status:u}){const[v,b]=f.useState(!1),l=f.useRef([]),{data:r,setData:o,post:m,processing:n,errors:x}=S({email:"",otp_arr:["","","","","",""],otp:""}),w=a=>{a.preventDefault(),m(route("login.otp.store"),{onSuccess:()=>b(!0)})},N=a=>{a.preventDefault(),m(route("login.otp.verify"))},y=(a,t)=>{var i;const{value:s}=a.target;if(/^\d*$/.test(s)&&s.length<=1){const p=[...r.otp_arr];p[t]=s,o("otp_arr",p),o("otp",p.join("")),s&&t<5&&((i=l.current[t+1])==null||i.focus())}},O=(a,t)=>{var s;a.key==="Backspace"&&!r.otp_arr[t]&&t>0&&((s=l.current[t-1])==null||s.focus())},L=a=>{var s;a.preventDefault();const t=a.clipboardData.getData("text/plain").trim();if(/^\d{6}$/.test(t)){const i=t.split("");o("otp_arr",i),o("otp",i.join("")),(s=l.current[5])==null||s.focus(),m(route("login.otp.verify"))}};return e.jsxs(E,{title:"Sign in with OTP",description:"Enter your email to receive a one-time password.",children:[e.jsx(D,{title:"Sign in with OTP"}),v?e.jsx("form",{className:"flex flex-col gap-6",onSubmit:N,children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"email",children:"Email address"}),e.jsx(d,{id:"email",type:"email",readOnly:!0,value:r.email,className:"bg-gray-100 cursor-not-allowed"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"otp",children:"One-Time Password"}),e.jsx("div",{className:"flex space-x-2",children:r.otp_arr.map((a,t)=>e.jsx(d,{id:`otp-${t}`,type:"text",maxLength:1,value:a,onChange:s=>y(s,t),onKeyDown:s=>O(s,t),onPaste:t===0?L:void 0,ref:s=>l.current[t]=s,className:"w-12 text-center",tabIndex:t+1},t))}),e.jsx(h,{message:x.otp})]}),e.jsxs(g,{type:"submit",className:"mt-4 w-full",tabIndex:7,disabled:n,children:[n&&e.jsx(j,{className:"h-4 w-4 animate-spin"}),"Log in"]})]})}):e.jsx("form",{className:"flex flex-col gap-6",onSubmit:w,children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"email",children:"Email address"}),e.jsx(d,{id:"email",type:"email",required:!0,autoFocus:!0,tabIndex:1,autoComplete:"email",value:r.email,onChange:a=>o("email",a.target.value),placeholder:"email@example.com"}),e.jsx(h,{message:x.email})]}),e.jsxs(g,{type:"submit",className:"mt-4 w-full",tabIndex:2,disabled:n,children:[n&&e.jsx(j,{className:"h-4 w-4 animate-spin"}),"Send OTP"]})]})}),e.jsx("div",{className:"mt-4 text-center text-sm",children:e.jsx(I,{href:route("login"),children:"Sign in with password"})}),u&&e.jsx("div",{className:"mb-4 text-center text-sm font-medium text-green-600",children:u})]})}export{K as default};
