import{r as n,j as i,b as H}from"./app-CMgd9CFO.js";import{A as U}from"./application-layout-cxP3cXNc.js";import V from"./AgGridTable-Ml2x6P89.js";import{ICCellRenderer as b}from"./Components-CmBqXCa1.js";import G from"./ConfirmModal-CGEyfTgQ.js";import L from"./ErrorModal-CU_6BZhY.js";import{N as Y,a as _,i as c,k as B,F as W}from"./renderers-BwbMJDu8.js";import{SaveNotification as z}from"./SaveNotification-BwEY2dnL.js";import{u as J}from"./useTranslation-Ca9ACeu7.js";import"./createLucideIcon-7qGfDxei.js";import"./paw-print-D0UC6vtx.js";import"./sparkles-DqCGk1FT.js";import"./calendar-C2mHZHpm.js";import"./plus-CceXe7IT.js";import"./user-BaUwBdqr.js";import"./search-LkEQWFqZ.js";import"./index-BuHSMQr-.js";import"./loader-circle-Ck6Q4JL4.js";import"./octagon-x-BipK8g0c.js";import"./circle-check-_zxMHciY.js";import"./WeeklyStatus-D3d20abn.js";import"./chevron-left-CX5OGnks.js";import"./chevron-right-NGM6CfF9.js";import"./library-E2nNABdg.js";import"./sun-DGPMDXGc.js";import"./PetDetailsSidebar-BDRneoM-.js";import"./constant-C0FE7K3f.js";import"./types-BJro-4LP.js";import"./index-DZZQifJx.js";import"./utils-jAU0Cazi.js";import"./send-CvqZSALe.js";import"./x-BWEyVoTj.js";import"./check-D-GLxgsM.js";function ye({pets:h,date:P,search:I}){const{t}=J(),[E,g]=n.useState(h.data);n.useEffect(()=>{g(h.data)},[h.data]);const[s,R]=n.useState({isOpen:!1,pet:null,status:""}),[u,N]=n.useState({isOpen:!1}),[w,O]=n.useState({isOpen:!1,message:""}),[D,f]=n.useState("idle"),[q,x]=n.useState(null),v=()=>{R({isOpen:!1,pet:null,status:""})},F=e=>{O({isOpen:!0,message:e})},A=()=>{s.pet&&(s.status=="Completed"?o({...s.pet,preparationStatus:"No"}):o({...s.pet,preparationStatus:"Completed"})),v()},l=(e,r)=>{N({isOpen:!0,text:e,title:r})},o=e=>{var p,C,k,T,j;const r=((p=e.specialRequestPawPrintInk)==null?void 0:p.completed)&&((C=e.specialRequestHairPluck)==null?void 0:C.completed)&&((k=e.specialRequestPawPrintClay)==null?void 0:k.completed)&&((T=e.specialRequestNoseImprint)==null?void 0:T.completed)&&((j=e.engraving)==null?void 0:j.completed),a={...e};e.preparationStatus!=="Completed"&&(r?a.preparationStatus="Yes":a.preparationStatus="No"),f("saving"),x(null),g(d=>d.map(y=>y.id===a.id?a:y)),H.post(route("pet.update-pet",{id:a.id}),a).then(d=>{f("success")}).catch(d=>{console.error("Error updating pet:",d),f("failure"),x(d.message||t("errorUnknown"))})},m=e=>{g(r=>r.map(a=>a.id===e.id?e:a))},M=e=>e?new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",S=e=>{if(!e)return"";const r=new Date(e),a=r.getFullYear(),p=String(r.getMonth()+1).padStart(2,"0");return`${String(r.getDate()).padStart(2,"0")}-${p}-${a}`},$=n.useMemo(()=>[{colId:"no",headerName:t("no"),valueGetter:"node.rowIndex + 1",width:60,pinned:"left"},{colId:"name",headerName:t("name"),cellRenderer:Y,width:120,valueGetter:e=>{var r;return(r=e.data)==null?void 0:r.name},pinned:"left",wrapText:!0,autoHeight:!0},{field:"cremationType",headerName:t("cremationTypeAbbr"),width:120,cellRenderer:b},{field:"notification",headerName:t("notification"),width:80,cellRenderer:_,cellRendererParams:{onUpdatePet:o}},{field:"pickupDateTime",headerName:t("pickUp"),flex:1,minWidth:180,valueFormatter:e=>e.data.isPickupDate==!0?t("ashesHereUntilUrnJewelryArrives"):e.value?new Date(e.value).toLocaleString("nl-BE"):""},c("specialRequestPawPrintInk",t("pawPrintInk"),l,o,m),c("specialRequestHairPluck",t("hairPluck"),l,o,m),c("specialRequestPawPrintClay",t("pawPrintClay"),l,o,m),c("specialRequestNoseImprint",t("noseImprint"),l,o,m),c("engraving",t("engraving"),l,o,m),{field:"following",headerName:t("following"),width:120,valueGetter:e=>S(e.data.following.datetime)},{field:"lastViewing",headerName:t("isOpenbaring"),width:120,cellRenderer:e=>i.jsx("div",{className:"cursor-pointer hover:underline",onClick:()=>{if(e.data.lastViewing){let r="";e.data.lastViewing.forEach(a=>{r+=`${S(a.datetime)}, ${M(a.datetime)} - ${a.description??""}
`}),l(r,t("isOpenbaring"))}},children:e.data.lastViewing&&e.data.lastViewing.map(r=>{var a,p;return i.jsxs("div",{children:[S(r.datetime),", ",M(r.datetime),r.description&&i.jsxs("span",{className:"truncate",children:["- ",(a=r.description)==null?void 0:a.slice(0,10),((p=r.description)==null?void 0:p.length)>10?"â€¦":""]})]},r.datetime)})})},c("others_info",t("other"),l,o,m),{colId:"actions",headerName:t("actions"),width:140,pinned:"right",cellRenderer:B,cellRendererParams:{setModalState:R,setErrorMessage:x,setStatus:f,openErrorModal:F},sortable:!1,filter:!1,resizable:!1}],[o]);return i.jsxs(U,{children:[i.jsx(z,{status:D,errorMessage:q}),i.jsx(V,{title:t("preparationRoom"),date:P,description:t("preparationRoomDesc"),pets:E,getRowStyle:e=>({background:e.data.preparationStatus==="Completed"?"#c5f2c5":""}),columnDefs:$,onUpdatePet:o,search:I}),i.jsx(G,{isOpen:s.isOpen,onClose:v,onConfirm:A,title:t("confirmNotification"),confirmText:t("yes"),message:s.pet?i.jsxs(i.Fragment,{children:[(s.status=="No"||s.status=="Yes")&&i.jsx("p",{className:"mb-4",children:t("confirmPreparationsCompleted")}),s.status=="Completed"&&i.jsx("p",{className:"mb-4",dangerouslySetInnerHTML:{__html:t("confirmRemoveCompleted")}})]}):null}),i.jsx(L,{isOpen:w.isOpen,onClose:()=>O({...w,isOpen:!1}),message:w.message,title:t("error")||"Error"}),u.isOpen&&i.jsx(W,{isOpen:u.isOpen,title:u.title,text:u.text,onClose:()=>N({isOpen:!1,title:"",text:""})})]})}export{ye as default};
